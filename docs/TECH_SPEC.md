## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ "MyFitnessSnap"

### üß± –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

* Telegram Bot (–±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫ –≤ Telegram)
* PHP Backend (REST API + Telegram webhook)
* PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
* AI-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (OpenAI GPT-4 Vision API)
* Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (SSR –Ω–∞ PHP)
* Docker Compose-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ –≤ Telegram-–±–æ—Ç
2. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç `file_id` –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ Telegram API
3. –§–æ—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ GPT-4 Vision API
4. AI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –µ–¥—ã + –∫–∞–ª–æ—Ä–∏–∏ + –ë–ñ–£
5. –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
6. –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Äî –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ Telegram –∏–ª–∏ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

### ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –û–±–ª–∞—Å—Ç—å       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                     |
| ------------- | ------------------------------ |
| –Ø–∑—ã–∫          | PHP 8.x                        |
| –ë–î            | PostgreSQL                     |
| –ë–æ—Ç           | php-telegram-bot/core          |
| AI            | OpenAI GPT-4 Vision            |
| –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | PHP SSR (Twig/Blade)           |
| –•–æ—Å—Ç–∏–Ω–≥       | Docker, Nginx, Supervisor      |
| Cron –∑–∞–¥–∞—á–∏   | –î–ª—è —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ø–ª–∞–Ω–æ–≤ |

---

### üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
myfitnesssnap/
‚îú‚îÄ‚îÄ bot/                    # Telegram webhook –∏ –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ BotHandler.php
‚îÇ   ‚îî‚îÄ‚îÄ TelegramRouter.php
‚îú‚îÄ‚îÄ public/                 # –í–µ–±-–¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ index.php
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ AI/                 # –†–∞–±–æ—Ç–∞ —Å GPT API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FoodAnalyzer.php
‚îÇ   ‚îú‚îÄ‚îÄ DB/                 # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MealRepository.php
‚îÇ   ‚îú‚îÄ‚îÄ Web/                # SSR-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes.php
‚îú‚îÄ‚îÄ scripts/                # cron-—Å–∫—Ä–∏–ø—Ç—ã –∏ –∑–∞–¥–∞–Ω–∏—è
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ php.Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ nginx.Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ postgres.Dockerfile
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

---

### üß© –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ –∫–ª–∞—Å—Å—ã

#### ‚úÖ `TelegramRouter.php`

* –ü–∞—Ä—Å–∏—Ç –≤—Ö–æ–¥—è—â–∏–µ –∞–ø–¥–µ–π—Ç—ã
* –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è (—Ñ–æ—Ç–æ, —Ç–µ–∫—Å—Ç, –∫–æ–º–∞–Ω–¥—ã)

#### ‚úÖ `FoodAnalyzer.php`

* –ü–æ–ª—É—á–∞–µ—Ç —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
* –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ GPT-4 Vision —Å –ø—Ä–æ–º–ø—Ç–æ–º
* –ü–æ–ª—É—á–∞–µ—Ç JSON: –±–ª—é–¥–æ, –∫–∞–ª–æ—Ä–∏–∏, –ë–ñ–£

#### ‚úÖ `MealRepository.php`

* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏—ë–º –ø–∏—â–∏
* –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é
* –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ü–µ–ª—è–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
* –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∏ —à–∞–±–ª–æ–Ω—ã

#### ‚úÖ `controllers/`

* `DashboardController`: –∫–∞–ª–æ—Ä–∏–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è, –≥—Ä–∞—Ñ–∏–∫–∏
* `GoalController`: —Ü–µ–ª–∏
* `MealController`: —Ä—É—á–Ω–æ–π –≤–≤–æ–¥, –∏—Å—Ç–æ—Ä–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –µ–¥—ã
* `StatsController`: –≤–µ—Å, –º–µ—Ç—Ä–∏–∫–∏ —Ç–µ–ª–∞, —ç–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤

#### ‚úÖ `routes.php`

* –ü—Ä–æ—Å—Ç–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤–∏–¥–∞:

```php
GET /dashboard => DashboardController@index
POST /goal => GoalController@update
POST /weight => StatsController@storeWeight
```

---

### üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  telegram_id BIGINT UNIQUE NOT NULL,
  name TEXT,
  daily_calories_goal INT DEFAULT 2000,
  protein_ratio INT DEFAULT 30,
  fat_ratio INT DEFAULT 30,
  carb_ratio INT DEFAULT 40,
  micronutrients JSONB,
  mode TEXT DEFAULT 'simple',
  meals_per_day INT DEFAULT 3,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE meals (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  photo_url TEXT,
  title TEXT,
  calories INT,
  protein DECIMAL(5,2),
  fat DECIMAL(5,2),
  carbs DECIMAL(5,2),
  micronutrients JSONB,
  meal_type TEXT,
  eaten_at TIMESTAMPTZ DEFAULT NOW(),
  raw_ai_data JSONB
);

CREATE TABLE body_stats (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  weight DECIMAL(5,2),
  fat_percent DECIMAL(5,2),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE daily_goals (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  day_of_week INT,
  calories INT,
  protein_ratio INT,
  fat_ratio INT,
  carb_ratio INT
);
```

---

### üß¨ –ü—Ä–æ—Ñ–∏–ª–∏: –ø—Ä–æ—Å—Ç–æ–π –∏ —Å–ª–æ–∂–Ω—ã–π —Ä–µ–∂–∏–º

* `simple`: —Ç–æ–ª—å–∫–æ –∫–∞–ª–æ—Ä–∏–∏ –∏ –ë–ñ–£
* `advanced`: –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —É—á—ë—Ç –º–∏–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤ (–∫–∞–ª–∏–π, –º–∞–≥–Ω–∏–π, –Ω–∞—Ç—Ä–∏–π, –∂–µ–ª–µ–∑–æ, –≤–∏—Ç–∞–º–∏–Ω—ã –∏ —Ç.–ø.)
* –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/mode simple` –∏–ª–∏ `/mode advanced`

---

### üçΩÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç –∫–æ–ª-–≤–æ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ `/meals set 5`
* –ö–∞–∂–¥—ã–π –ø—Ä–∏—ë–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω: `breakfast`, `lunch`, `dinner`, `snack`, –∏ —Ç.–¥.
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ `/repeat last` –∏–ª–∏ –≤—ã–±–æ—Ä –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

---

### üìä –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-–¥–∏–∞–≥—Ä–∞–º–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–µ—Ä–µ–∑ GD, ImageMagick –∏–ª–∏ matplotlib)
* –ö—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ –ë–ñ–£ –∏ –º–∏–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∞–º
* –ì—Ä–∞—Ñ–∏–∫–∏ –≤–µ—Å–∞, –∫–∞–ª–æ—Ä–∏–π, –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Ü–µ–ª–µ–π
* –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Telegram

---

### üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–∏—ë–º–∞—Ö –ø–∏—â–∏ `/remind at 13:00`
* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram API –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron)

---

### üì¶ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

* –≠–∫—Å–ø–æ—Ä—Ç –¥–Ω–µ–≤–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –≤–µ—Å–∞ –≤ PDF/CSV
* –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Telegram `/export week` –∏–ª–∏ —á–µ—Ä–µ–∑ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

* –ß–µ—Ä–µ–∑ Telegram OAuth (–∏–ª–∏ —Ä—É—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–¥—É)
* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–π –Ω–∞ –≤–µ–±–µ —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω—ã

---

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

* –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ / –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ –≤ –¥–µ–Ω—å
* –°—Ä–µ–¥–Ω—è—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å
* –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ / –Ω–µ—Ç
* –í–µ—Å –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ –¥–Ω—è–º / –Ω–µ–¥–µ–ª—è–º
* –ß–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ–º—ã–µ –±–ª—é–¥–∞

---

### üîÑ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ

* –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (Whisper API)
* –†–∞—Å—á—ë—Ç –º–∏–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤
* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ (PDF)
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Apple Health / Google Fit
* –ü–ª–∞—Ç–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
* –î—Ä—É–∑—å—è –∏ —á–µ–ª–ª–µ–Ω–¥–∂–∏ (—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
* API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

---

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* Unit-—Ç–µ—Å—Ç—ã (PHPUnit): –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã: Telegram API + DB
* e2e —Ç–µ—Å—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Playwright/Pest)

---

### üß≠ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

* –ß–µ—Ä–µ–∑ Docker Compose
* –°–µ—Ä–≤–µ—Ä Ubuntu: Nginx + PHP-FPM + PostgreSQL
* Webhook Telegram —Å—Ç–∞–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ CLI

```bash
curl -F "url=https://example.com/bot/webhook.php" https://api.telegram.org/bot<token>/setWebhook
```

---

### üßæ –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

* –•—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –≤ `/logs`
* –û—à–∏–±–∫–∏ AI –∏ Telegram –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `error.log`
* –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ Prometheus (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
